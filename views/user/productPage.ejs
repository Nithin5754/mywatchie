<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>mywatchie.com</title>
  <script src="https://kit.fontawesome.com/72e1a8d80d.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="dist/output.css">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.15/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/darkmode.css">

<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />


  <!-- googlr icons materials -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0" />

</head>

<body class="bg-gray-100 text-white scroll-smooth">


<%- include('./partials/header.ejs',{isProfile,isUrl,islogout,isCreateAccount,isCreateAccountUrl,cartItems, verifyUserEmail}) %>




<!-- drawer init and show -->
<div  class="text-end   mt-24 ml-4">
  <button  id="sidebarbutton" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800" type="button" >
  Filters
  </button>
  <button id="searchBtn-categoryWise" 
  class="text-white bg-gray-500 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2.5 text-center inline-flex dark:bg-blue-600 dark:hover:bg-gray-500 dark:focus:ring-blue-800 w-28 m-4"
  type="button">
  search
 <span class="pl-4"> <i class="fas fa-search"></i></span>
</button>



</div>
<aside >


<!-- drawer component -->
<div  id="sidebar" style="display: none;" class="   fixed mt-20 top-0 left-0 z-40 w-64 h-screen p-4 overflow-y-auto  -translate-x-full bg-white dark:bg-gray-800" tabindex="-1" aria-labelledby="drawer-navigation-label">
  <div class="flex flex-row justify-between relative">
    <h5 id="drawer-navigation-label" class="text-base font-semibold text-gray-500 uppercase dark:text-gray-400">filters</h5>
    <button type="button" id="close-filter" data-drawer-hide="drawer-navigation"  class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 absolute top-1 right-1 inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white">
      <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
      </svg>
      <span class="sr-only">Close menu</span>
    </button>
  </div>
  
<div class="py-4 overflow-y-auto">
    <ul class="space-y-2 font-medium">
       <li>
        <h2 class="text-xl font-bold mt-14 text-gray-900">Filter and Sort</h2>
        <div>
          <h3 class="text-md font-semibold text-gray-900">Discount</h3>
          <select class="w-full py-1 px-2 rounded-md bg-gray-100 text-gray-900 " name="discountSort" id="discountSort"
            data-category="<%= categoryName %>">
            <option value="all" <%=isDiscount==='all' ?'selected':'' %>>All</option>
            <option value='90' <%=isDiscount==='90' ?'selected':'' %> >90% and more</option>
            <option value="70" <%=isDiscount==='70' ?'selected':'' %>>70% and more</option>
              <option value="50" <%=isDiscount==='50' ?'selected':'' %>>50% and more</option>
                <option value="30" <%=isDiscount==='30' ?'selected':'' %>>30% and more</option>
                  <option value="10" <%=isDiscount==='10' ?'selected':'' %>>10% and more</option>
                    <option value="5" <%=isDiscount==='5' ?'selected':'' %>>5% and more</option>
            <!-- Add more sorting options here -->
          </select>
        </div>
       </li>
       <li>
        <div>
          <h3 class="text-md font-semibold text-gray-900">star rating</h3>
          <select class="w-full py-1 px-2 rounded-md bg-gray-100 text-gray-900" name="ratingSort" id="ratingSort"
            data-category="<%= categoryName %>">
            <option value="all" <%=isStar==='all' ?'selected':'' %>>All</option>
            <option value='5' <%=isStar==='5' ?'selected':'' %> >5 and more<span class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600">★</span></option>
            <option value="4" <%=isStar==='4' ?'selected':'' %>>4<span class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600">★</span></option>
            <option value="3" <%=isStar==='3' ?'selected':'' %>>3<span class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600">★</span></option>
            <option value="2" <%=isStar==='2' ?'selected':'' %>>2 <span class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600">★</span></option>
            <option value="1" <%=isStar==='1' ?'selected':'' %>>below 1 <span class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600">★</span></option>
          
            <!-- Add more sorting options here -->
          </select>
        </div>
       </li>
       <li>
        <div>
          <h3 class="text-md font-semibold text-gray-900">Sort By</h3>
          <select class="w-full py-1 px-2 rounded-md bg-gray-100 text-gray-900" name="sortby " id="priceSort" data-category="<%= categoryName %>">
            <option value="relevance" <%= isSort==='relevance'?'selected':'' %>>Relevance</option>
            <option value="price-low-to-high" <%= isSort==='price-low-to-high'?'selected':'' %> >Price Low to High</option>
            <option value="price-high-to-low" <%= isSort==='price-high-to-low'?'selected':'' %>>Price High to Low</option>
            <!-- Add more sorting options here -->
          </select>
        </div>
       </li>
      
 
    </ul>
 </div>
</div>

</aside>









<main  id="product-box" class="">


  <section>
        <%- include('./partials/search.ejs',{categoryName}) %>
  </section>
  
  



  <!-- Second Section: Product List without Swiper -->
  <section>
    <h1 class="text-center font-extrabold text-3xl mt-14 text-gray-500"><%= categoryName %></h1>

    


   <% if(isProductListFilter.length>0){ %>
   <ul class="flex flex-wrap  justify-center  ">
      
      <% isProductListFilter.forEach((element, index)=> { %>
        
        <li
          class="searchable-item relative m-2 md:m-4 lg:m-10 flex w-full h-auto max-w-xs flex-col overflow-hidden rounded-lg border border-gray-100 bg-white shadow-md" >
          <a class="relative mx-2 mt-2 md:mx-3 md:mt-3 lg:mx-4 lg:mt-4 h-28 md:h-52 overflow-hidden rounded-xl flex flex-col justify-between"
            href="/productList/details/<%= element._id %>">
            <img id="image" class="object-contain w-full h-full md:h-52 lg:h-60"
              src="/<%= element.product_image_url[0] %>" alt="<%= element.product_image_url[0] %>" />
            <% if (element.product_discount>0) { %>
              <span
              class="absolute top-0 left-0 m-2 rounded py-1 px-4  opacity-80 hover:text-black hover:bg-gray-400   transition-all text-center text-xs md:text-sm lg:font-medium text-white bg-black">
              <%= element.product_discount %>%
                OFF
            </span>
          <%  } else { %>
            <span>
           
          </span>
          <%  } %>
          </a>
          <div class="mt-2 md:mt-4 px-2 md:px-5 pb-2 md:pb-5">
            <a href="#">
            <h5 class="product-name sm:text-lg md:text-xl lg:text-2xl tracking-tight text-gray-800 ">
              <%= element.product_name %>
            </h5>
          
            </a>
            <div class="mt-1 md:mt-2 mb-3 md:mb-5 flex items-center justify-between">
              <p>
                <% if (element.product_discount>0) { %>
                    <span class="sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-900 ">$ <%= (element.product_price * (1 - element.product_discount / 100)).toFixed(2) %>
                </span>
                  
              <%  }else{ %>
                  <span class="sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-900 ">$ <%= element.product_price  %>
                </span>
             <%   } %>
                <span class="text-xs sm:text-sm md:lg:text-lg text-gray-500 line-through">$<%= element.product_price %>
                </span>
              </p>
              <div class="flex items-center space-x-1 md:space-x-2">
                <svg aria-hidden="true" class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600" fill="currentColor"
                  viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z">
                  </path>
                </svg>
            
                <span class="h-4 sm:h-5 md:h-6 lg:h-7 text-red-600">★</span>
                <span
                  class="mr-2 ml-3 rounded bg-red-600 px-1 sm:px-2 md:px-3 lg:px-4 text-xs sm:text-sm md:lg:text-lg font-semibold text-white"><%= element.product_rating %></span>
              </div>
            </div>
            <div class="flex flex-col gap-3">
                  <% if (element.product_qty<=0||element.isListed===false) { %>
                    <p  class="flex items-center justify-center w-full bg-red-900 px-2 py-1 text-sm text-white transition hover:bg-gray-700 rounded-md">out of stock</p>
                   
                  <% }else{ %>
                               <button
                class="flex items-center justify-center w-full bg-gray-900 px-2 py-1 text-sm text-white transition hover:bg-gray-700 rounded-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="mr-2 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path
                    d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z">
                  </path>
                </svg>
                <a href=''>Buy now</a>
              </button>
              <p class=" text-gray-900 text-center text-sm font-bold"><%= element.product_qty<=5?`${element.product_qty} more left`:'' %></p>
               <% } %>
            </div>
          </div>
        </li>
        <% }) %>
    </ul>
  <% }else{ %>
    <ul class="flex flex-wrap  justify-center gap-2 sm:mb-24 ">
      <p id="emptyProduct" class="text center "></p>
    </ul>
  <% }  %>

  
  </section>








</main>


<section class="my-6 flex  justify-center gap-3">
  <p class="text-gray-900 font-bold items-center my-auto"><%= paginate.page %> out of <%= maxPage %></p>
  <div class="pagination flex justify-end gap-4">
  
    <% if (paginate.hasPreviousPages) { %>
      <a href="?page=<%= paginate.page-1 %>"
        class="bg-blue-500 text-white px-2 py-2 rounded hover:bg-blue-600">Previous</a>
      <% } %>

        <% if (paginate.hasNextPages && page<maxPage) { %>
          <a href="?page=<%= paginate.page+1  %>"
            class="bg-blue-500 text-white px-2 py-2 rounded hover:bg-blue-700 focus:bg-blue-700 focus:outline-none transition duration-300 ease-in-out">
            Next
          </a>
          <% } %>
  </div>
</section>

</div>
<%- include('./partials/foooter.ejs') %>

    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <!-- font-awesome -->
    <script src="https://kit.fontawesome.com/72e1a8d80d.js" crossorigin="anonymous"></script>
    <script src="/js/darkmode.js"></script>
   
    <script src="/js/productSearch.js"></script>

  <script>
  var swiper = new Swiper(".mySwiper", {
      slidesPerView: 1, 
      spaceBetween: 20, 
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      breakpoints: {
        // Responsive breakpoints
        640: {
          slidesPerView: 2, 
          spaceBetween: 30, 
        },
        768: {
          slidesPerView: 3,
          spaceBetween: 40,
        },
        1024: {
          slidesPerView: 4, 
          spaceBetween: 50, 
        },
      },
    });

  </script>


<script src="/js/sortby.js"></script>
<script src="/js/brandSort.js"></script>
<script src="/js/discount.js"></script>
<script src="/js/rating.js"></script>







<script>
   const sideBarButton=document.querySelector('#sidebarbutton')
   const sidebar=document.querySelector('#sidebar')
   const productBox=document.querySelector('#product-box')
   const filterId=document.querySelector('#close-filter')

   sideBarButton.addEventListener('click',()=>{
    sidebar.style.display="block"
    // productBox.style.display="none"
   })

   filterId.addEventListener('click',()=>{
    sidebar.style.display="none"
    // productBox.style.display="block"
   })



</script>




<script>
  const searchBtn=document.getElementById('searchBtn-categoryWise')
  const searchInp=document.getElementById('search-categoryWise-Box')

  searchBtn.addEventListener('click',()=>{
    searchInp.style.display=  searchInp.style.display==='none'?'block':'none'
  })
</script>



<script>
  const searchInput = document.getElementById('userSearch');
  const searchableItems = document.querySelectorAll('.searchable-item'); 

  searchInput.addEventListener('input', () => {
    const searchText = searchInput.value.toLowerCase();
   

    searchableItems.forEach(item => {
      const itemText = item.textContent.toLowerCase();

      if (itemText.includes(searchText)) {
        item.style.display = 'block';
      
      } else {
        item.style.display = 'none';
      }
    });

   
  });

</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.5/lottie.min.js"></script>
<script>
  bodymovin.loadAnimation({
    container: document.getElementById('emptyProduct'),
    path:'/json/emptyProduct.json',
  });
</script>

</body>

</html>




